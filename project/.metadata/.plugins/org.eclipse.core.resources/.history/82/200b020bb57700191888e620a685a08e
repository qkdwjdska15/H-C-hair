package controller;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import model.customerVO;

public class CustomerDAO {

	// 신규 고객 등록
	public customerVO getCustomerRegiste(customerVO cVo) throws Exception {

		// 데이터 처리를 위한 SQL문
		StringBuffer sql = new StringBuffer();
		sql.append("insert into schoolchild");
		sql.append(" (c_code,c_name,c_gender,c_phone,c_age,c_address,c_tiket_rating,c_expiration_date,c_tiket_sales)");
		sql.append(" values (customer_seq.nextval,?,?,?,?,?,?,TO_CHAR(sysdate+365),?)");

		Connection con = null;
		PreparedStatement pstmt = null;
		customerVO retval = null;

		try {
			// DBUtil 이라는 클래스의 getConnenction()메소드로 데이터베이스와 연결
			con = DBUtil.getConnection();

			// 입력받은 학생 정보를 처리하기 위하여 SQL문장 생성
			pstmt = con.prepareStatement(sql.toString());
			pstmt.setString(1, cVo.getC_name());
			pstmt.setString(2, cVo.getC_gender());
			pstmt.setString(3, cVo.getC_phone());
			pstmt.setString(4, cVo.getC_age());
			pstmt.setString(5, cVo.getC_address());
			pstmt.setString(6, cVo.getC_tiket_rating());
			pstmt.setString(7, cVo.getC_tiket_sales());

			// SQL문을 수행 후 처리 결과 얻어온다.
			int i = pstmt.executeUpdate();

			retval = new customerVO();

		} catch (SQLException e) {
			System.out.println("e=[" + e + "]");
		} catch (Exception e) {
			System.out.println("e=[" + e + "]");
		}finally {
			try {
				if(pstmt != null) {
					pstmt.close();
				}
				if(con != null) {
					con.close();
				}
				
			} catch (SQLException e) {
			}
		}
		return retval;
	}
}
